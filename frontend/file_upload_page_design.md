# 项目方文件上传页面设计图

## 1. 页面整体布局

```
+----------------------------------------------------------+
|                    项目方数据提交平台                     |
+----------------------------------------------------------+
| 导航栏：logo | 数据提交 | 项目管理 | 历史记录 | 帮助中心 |
+----------------------------------------------------------+

+----------------------------------------------------------+
|                      数据提交表单                         |
|                                                          |
|  +-----------------------+  +-------------------------+  |
|  |   项目信息区域        |  |   文件上传区域          |  |
|  |                       |  |                         |  |
|  |  项目ID：[输入框]     |  |  +-------------------+  |  |
|  |  数据日期：[日期显示] |  |  |  多文件上传       |  |  |
|  |  (自动获取当前日期)   |  |  +-------------------+  |  |
|  |                       |  |  |  [选择多个文件按钮]|  |  |
|  |  核心数据字段1：[文本框]|  |  |  文件列表：       |  |  |
|  |  [删除字段]            |  |  |   - file1.txt (10KB)|  |  |
|  |                       |  |  |   - file2.jpg (50KB)|  |  |
|  |  核心数据字段2：[文本框]|  |  |   - file3.pdf (200KB)| |  |
|  |  [删除字段]            |  |  |  [哈希计算结果]   |  |  |
|  |                       |  |  +-------------------+  |  |
|  |  [添加更多核心数据字段]|  |                         |  |
|  +-----------------------+  +-------------------------+  |
|                                                          |
|  +----------------------------------------------------+  |
|  |                  操作按钮区域                        |  |
|  |                                                    |  |
|  |                 [一键上传]                          |  |
|  |  (计算哈希 + 提交到后台 + 提交到合约)                |  |
|  |                                                    |  |
|  |                 [保存草稿]                          |  |
|  +----------------------------------------------------+  |
|                                                          |
|  +----------------------------------------------------+  |
|  |                  状态显示区域                        |  |
|  |                                                    |  |
|  |  操作进度：[步骤指示器]                              |  |
|  |  1. 计算哈希：[完成/进行中/失败]                     |  |
|  |  2. 提交到后台：[完成/进行中/失败]                   |  |
|  |  3. 提交到合约：[完成/进行中/失败]                   |  |
|  |  合约交易哈希：[显示交易哈希]                        |  |
|  +----------------------------------------------------+  |
+----------------------------------------------------------+

+----------------------------------------------------------+
|                    页脚信息                              |
|  版权所有 © 2023 数据提交平台 | 版本号：v1.0.0          |
+----------------------------------------------------------+
```

## 2. 核心功能模块设计

### 2.1 项目信息区域

| 组件名称       | 类型       | 功能描述                                   | 验证规则                     |
|----------------|------------|--------------------------------------------|------------------------------|
| 项目ID输入框   | 文本输入框 | 输入项目唯一标识符                         | 必填，格式验证               |
| 数据日期显示区 | 文本显示   | 自动显示当前日期                           | 不可编辑                     |
| 核心数据文本框 | 多行文本框 | 输入核心数据内容（可动态添加多个）         | 至少一个核心数据字段必填     |
| 添加字段按钮   | 按钮       | 动态添加更多核心数据字段                   | -                            |
| 删除字段按钮   | 按钮       | 删除对应的核心数据字段                     | 至少保留一个字段             |

### 2.2 文件上传区域

| 组件名称       | 类型       | 功能描述                                   | 验证规则                     |
|----------------|------------|--------------------------------------------|------------------------------|
| 多文件选择按钮 | 按钮       | 打开文件选择对话框，支持多选               | -                            |
| 文件列表显示   | 列表显示   | 显示已选择的所有文件名和大小               | -                            |
| 哈希值显示区   | 文本显示   | 显示所有文件的哈希计算结果                 | -                            |

### 2.3 操作按钮区域

| 组件名称       | 类型       | 功能描述                                   | 状态条件                     |
|----------------|------------|--------------------------------------------|------------------------------|
| 一键上传按钮   | 按钮       | 整合操作：计算哈希 + 提交到后台 + 提交到合约 | 项目ID已填写，至少选择一个文件，至少一个核心数据字段已填写 |
| 保存草稿按钮   | 按钮       | 将当前表单内容保存为草稿                   | 项目ID已填写                 |

### 2.4 状态显示区域

| 组件名称       | 类型       | 功能描述                                   | 显示内容                     |
|----------------|------------|--------------------------------------------|------------------------------|
| 操作步骤指示器 | 步骤条     | 显示一键上传的三个步骤进度                 | 计算哈希、提交到后台、提交到合约的完成状态 |
| 哈希计算状态   | 文本显示   | 显示文件哈希计算的状态                     | 计算中、计算成功、计算失败   |
| 后台上传状态   | 进度条+文本 | 显示文件上传到后台的进度和状态             | 进度百分比、上传成功/失败     |
| 合约交易状态   | 文本显示   | 显示智能合约交易的状态和哈希               | 交易哈希、交易确认状态       |

## 3. 数据流向设计

```
用户操作流程：
1. 输入项目信息
2. 添加核心数据字段
3. 选择多个文件
4. 点击一键上传按钮
5. 系统自动完成：计算哈希 -> 提交到后台 -> 提交到合约

数据流向：
+------------------+     +------------------+     +------------------+
|  用户输入数据     | --> |  前端处理        | --> |  后台服务器      |
|  (项目ID, 日期,   |     |  (自动计算文件哈希,|     |  (存储文件,      |
|   核心数据, 文件)  |     |   验证数据格式)   |     |   记录哈希值)    |
+------------------+     +------------------+     +------------------+
          |                                              |
          |                                              |
          |                  +------------------+        |
          |                  |  智能合约        |        |
          |                  |  (存储核心数据    |        |
          +----------------->|   和哈希值)      |<-------+
                             +------------------+
```

## 4. 核心交互流程

### 4.1 一键上传整合流程

```
1. 用户点击"一键上传"按钮
2. 前端验证所有必填项：
   - 项目ID已填写
   - 至少选择一个文件
   - 至少一个核心数据字段已填写
3. 前端显示操作步骤指示器，开始执行第一步：计算哈希
4. 哈希计算流程：
   - 前端使用SHA-256等算法计算所有选定文件的哈希值
   - 实时更新哈希计算状态
   - 计算完成后，显示所有文件的哈希值
5. 后台上传流程：
   - 步骤指示器进入第二步：提交到后台
   - 前端显示后台上传进度条
   - 前端将所有文件和对应的哈希值通过API发送到后台服务器
   - 后台服务器接收文件并存储
   - 后台验证每个文件的哈希值是否正确
   - 后台返回上传结果给前端
   - 前端更新后台上传状态显示
6. 合约提交流程：
   - 步骤指示器进入第三步：提交到合约
   - 前端检查后台上传是否成功
   - 前端调用Web3.js/ethers.js与智能合约交互
   - 前端显示交易确认对话框，请求用户签名
   - 用户在钱包中确认交易
   - 前端显示合约交易状态和交易哈希
   - 前端轮询区块链确认交易是否成功
   - 前端更新合约交易状态显示
7. 整个流程完成后，显示最终结果（成功/失败）
```

### 4.2 多文件选择与核心数据管理流程

```
1. 核心数据管理：
   - 页面加载时显示一个核心数据字段
   - 用户可以输入核心数据内容
   - 用户可以点击"添加更多核心数据字段"按钮动态添加字段
   - 用户可以点击"删除字段"按钮删除不需要的字段
   - 至少保留一个核心数据字段

2. 多文件选择：
   - 用户点击"选择多个文件"按钮
   - 文件选择对话框打开，用户可以选择多个文件（支持Ctrl/Shift键多选）
   - 选定的文件列表显示在页面上，包含文件名和大小
   - 用户可以重新选择文件来替换当前列表
```

## 5. 技术实现要点

### 5.1 前端技术栈

- **框架**：React
- **UI组件库**：Ant Design/Material UI
- **文件处理**：File API
- **哈希计算**：CryptoJS/SHA-256
- **区块链交互**：Web3.js/ethers.js
- **HTTP请求**：Axios

### 5.2 后台技术栈

- **服务器**：Go
- **文件存储**：本地存储/云存储（AWS S3、阿里云OSS）
- **数据库**：MongoDB/MySQL
- **API**：RESTful API

### 5.3 智能合约技术

- **区块链平台**：Ethereum
- **开发语言**：Solidity
- **合约功能**：存储核心数据和哈希值
- **事件**：DataSubmitted事件记录数据提交

## 6. 安全考虑

- **文件验证**：验证文件类型、大小、哈希值
- **数据加密**：传输过程中使用HTTPS加密
- **访问控制**：项目方身份验证和授权
- **合约安全**：防止重入攻击、溢出攻击等
- **数据备份**：文件和数据的定期备份

## 7. 用户体验优化

- **实时验证**：输入时实时验证数据格式
- **进度反馈**：上传和交易过程中的进度显示
- **错误提示**：清晰的错误信息和解决方案
- **操作确认**：重要操作的确认对话框
- **历史记录**：查看过去提交的记录
- **响应式设计**：适配不同屏幕尺寸

## 8. 扩展性考虑

- **多文件上传**：支持批量上传多个文件
- **自定义字段**：允许项目方自定义核心数据字段
- **多链支持**：支持不同区块链网络
- **API集成**：提供API供其他系统集成
- **数据分析**：提供数据统计和分析功能